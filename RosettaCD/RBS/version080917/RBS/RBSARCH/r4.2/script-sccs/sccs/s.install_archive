h35073
s 00004/00004/00125
d D 1.5 95/12/04 10:44:16 rous 5 4
c 
e
s 00001/00001/00128
d D 1.4 95/10/26 16:10:19 rous 4 3
c 
e
s 00002/00027/00127
d D 1.3 95/10/18 14:06:33 rous 3 2
c 
e
s 00154/00001/00000
d D 1.2 95/10/17 11:08:06 rous 2 1
c 
e
s 00001/00000/00000
d D 1.1 95/10/17 09:01:05 rous 1 0
c date and time created 95/10/17 09:01:05 by rous
e
u
U
f e 0
t
T
I 1
D 2
 
E 2
I 2
#! /bin/sh -e
set -e
#set -v
#set -x
umask 002
trap 'umask 022 ; echo "INSTALL: Error during installation; Remove installed directories; warn the RBS system manager!!"; exit 2' 0
#
echo "INSTALL: What is the full path to the archive directory? (e.g. /home/user/archive)"
read ARCH_DIR
#
echo "INSTALL: Creating archive directory...."
mkdir $ARCH_DIR
rm -f tempuid
$RBS_DIR/getuid > tempuid
D 4
cat $RBS_DIR/SOURCES/fuid.c | sed -f tempuid > $ARCH_DIR/fuid.c
E 4
I 4
cat $RBS_DIR/fuid.c | sed -f tempuid > $ARCH_DIR/fuid.c
E 4
rm -f tempuid
cc -o $ARCH_DIR/fuid $ARCH_DIR/fuid.c
chmod ug+rwxs $ARCH_DIR/fuid
rm -f $ARCH_DIR/fuid.c
#
echo "INSTALL: What is the name of the release directory? (e.g. release3)"
read RELEASE_DIR
#
echo "INSTALL: Creating release directory...."
mkdir $ARCH_DIR/$RELEASE_DIR
cd $ARCH_DIR/$RELEASE_DIR
#
echo "INSTALL: Creating actions component in the release directory...."
mkdir actions
chmod g+rwx actions
mkdir actions/sccs
chmod g+rwx actions/sccs
echo "actions       actions/ +" > RBS_logicals
echo '              $(RBS_ARCHIVE)$(RBS_RELEASE)/actions/' >> RBS_logicals
#
#
echo "INSTALL: Creating doc component in the release directory...."
mkdir doc
chmod g+rwx doc
mkdir doc/sccs
chmod g+rwx doc/sccs
echo "doc    doc/source/ +" >> RBS_logicals
echo "       doc/target/ +" >> RBS_logicals
echo '       $(RBS_ARCHIVE)$(RBS_RELEASE)/doc/' >> RBS_logicals
echo "======================================" > doc/doc_survey.rbs
chmod ug+rwx doc/doc_survey.rbs
#
#
#  Install doc.make file and the manual.fm file
#
   cd doc
#
   cp $RBS_DIR/doc.make doc.make
D 5
   chmod ug+rwx doc.make
E 5
I 5
   chmod ug=rx doc.make
E 5
   uuencode doc.make doc.make > doc.make.ascii
   sccs -d$ARCH_DIR/$RELEASE_DIR/doc -psccs enter doc.make.ascii
D 5
   chmod ug+rwx sccs/s.doc.make.ascii
E 5
I 5
   chmod ug=rwx sccs/s.doc.make.ascii
E 5
   rm -f ,doc.make.ascii doc.make.ascii
#
   cp $RBS_DIR/manual.fm manual.fm
D 5
   chmod ug+rwx manual.fm
E 5
I 5
   chmod ug=rx manual.fm
E 5
   uuencode manual.fm manual.fm > manual.fm.ascii
   sccs -d$ARCH_DIR/$RELEASE_DIR/doc -psccs enter manual.fm.ascii
D 5
   chmod ug+rwx sccs/s.manual.fm.ascii
E 5
I 5
   chmod ug=rwx sccs/s.manual.fm.ascii
E 5
   rm -f ,manual.fm.ascii manual.fm.ascii
#
   cd $ARCH_DIR/$RELEASE_DIR
#
#
#
echo 'cd $RBS_USER_ROOT$RBS_USER' > RBS_install
echo "mkdir $RELEASE_DIR" >> RBS_install
echo "cd $RELEASE_DIR" >> RBS_install
echo 'cp $RBS_ARCHIVE$RBS_RELEASE/RBS_logicals RBS_logicals' >> RBS_install
echo 'echo "INSTALL: creating component directory actions"' >> RBS_install
echo "mkdir actions" >> RBS_install
echo 'echo "INSTALL: creating component directory doc"' >> RBS_install
echo "mkdir doc" >> RBS_install
echo "mkdir doc/source" >> RBS_install
echo "mkdir doc/target" >> RBS_install
echo "mkdir doc/save" >> RBS_install
#
#
D 3
echo "  "
echo "INSTALL: Give the list of DOMAIN DEPENDENT components (separated by"
echo "         spaces). Don't use the name <doc> or <actions>!"
read LANG_COMPONENTS
echo $LANG_COMPONENTS > RBS_domains
echo "  "
for component in $LANG_COMPONENTS
do 
   echo "INSTALL: Creating component $component in the current release...."
   mkdir $component
   chmod g+rwx $component
   mkdir $component/sccs
   chmod g+rwx $component
   echo "$component    $component/source/ +" >> RBS_logicals
   echo "              $component/target/ +" >> RBS_logicals
   echo -n '              $(RBS_ARCHIVE)$(RBS_RELEASE)/' >> RBS_logicals
   echo "$component/" >> RBS_logicals
E 3
#
D 3
   echo "echo 'INSTALL: creating component directory $component'" >> RBS_install
   echo "mkdir $component" >> RBS_install
   echo "mkdir $component/source" >> RBS_install
   echo "mkdir $component/target" >> RBS_install
   echo "mkdir $component/save" >> RBS_install
#
done
#
E 3
echo "  "
D 3
echo "INSTALL: Give a list of DOMAIN INDEPENDENT components (separated by"
echo "         spaces. Don't use the name <doc> or <actions>!"
E 3
I 3
echo "INSTALL: Give a list of components (separated by spaces)."
echo "         Don't use the name <doc> or <actions>!"
E 3
read COMPONENTS
echo "  "
for component in $COMPONENTS
do 
   echo "INSTALL: Creating component $component in the current release...."
   mkdir $component
   chmod g+rwx $component
   mkdir $component/sccs
   chmod g+rwx $component
   echo "$component    $component/source/ +" >> RBS_logicals
   echo "              $component/target/ +" >> RBS_logicals
   echo -n '              $(RBS_ARCHIVE)$(RBS_RELEASE)/' >> RBS_logicals
   echo "$component/" >> RBS_logicals
#
   echo "echo 'INSTALL: creating component directory $component'" >> RBS_install
   echo "mkdir $component" >> RBS_install
   echo "mkdir $component/source" >> RBS_install
   echo "mkdir $component/target" >> RBS_install
   echo "mkdir $component/save" >> RBS_install
#
done
#
echo "chmod -R u+rwx *" >> RBS_install
echo "chmod -R g+rx *" >> RBS_install
#
#
echo "========INTEGRATION HISTORY===========" > history.rbs
chmod ug+rwx history.rbs
echo "  "
#
echo -n "" > RBS_users
#
#
#
chmod ug+rwx RBS_users
chmod ug+rwx RBS_logicals
chmod ug+rwx RBS_install
#
#
umask 022
echo "Done"
trap 0
E 2
E 1
